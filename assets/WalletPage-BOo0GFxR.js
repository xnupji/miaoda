import{c as D,u as le,a as ne,r as l,j as e,W as G,B as n,b as c,t as r}from"./index-DO7n6nzw.js";import{C as f,b as w,c as b,d as T,a as C,L as j}from"./card-BmWYKBSd.js";import{L as m,I as u}from"./label-CPVWgnt3.js";import{A as p,a as g}from"./alert-DpFwWlpI.js";import{D as ce,a as ie,b as de,c as oe,d as xe,e as me}from"./dialog-Anzkq6Bh.js";import{h as J,i as he,u as je,j as ue,k as pe}from"./api-DvilJfax.js";import{T as ge,a as Ne,b as K,c as N,d as ye,e as y}from"./table-B9Z0vAQV.js";import{C as A}from"./circle-alert-DST-bK5r.js";import{C as ve}from"./copy-BsnPLPsp.js";/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],we=D("circle-check",fe);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],Te=D("link",be);/**
 * @license lucide-react v0.553.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],ke=D("send",Ce);function Ue(){var E,O;const{profile:a,refreshProfile:_}=le(),{account:k,isConnected:h,connectWallet:Q,isCorrectNetwork:o}=ne(),[v,P]=l.useState(!1),[B,V]=l.useState([]),[X,H]=l.useState(!0),[t,x]=l.useState({amount:"",tokenType:"HTP",toAddress:"",paymentAddress:""}),[W,F]=l.useState(!1),[U,Y]=l.useState(""),[i,Z]=l.useState("30"),[q,M]=l.useState(!1),[S,z]=l.useState(""),[L,R]=l.useState(!1);l.useEffect(()=>{I(),ee()},[]);const ee=async()=>{const s=await J("developer_usdt_address"),d=await J("wallet_activation_fee");s&&Y(s),d&&Z(d)},I=async()=>{H(!0);const s=await he();V(s),H(!1)},$=async()=>{if(!h||!k){r.error("请先连接钱包");return}if(!o){r.error("请切换到BSC网络");return}P(!0);const s=await je({wallet_address:k});P(!1),s?(r.success("钱包地址绑定成功！"),await _()):r.error("绑定失败，请稍后重试")},se=async()=>{try{await navigator.clipboard.writeText(U),M(!0),r.success("地址已复制到剪贴板"),setTimeout(()=>M(!1),2e3)}catch{r.error("复制失败，请手动复制")}},ae=async()=>{const s=parseFloat(S);if(isNaN(s)||s<parseFloat(i)){r.error(`请输入至少 ${i} USDT`);return}R(!0);const d=await ue(s);R(!1),d?(r.success("钱包激活成功！现在可以提取HTP代币了"),await _(),z("")):r.error("激活失败，请稍后重试")},te=async()=>{if(!t.amount||!t.toAddress){r.error("请填写完整信息");return}const s=parseFloat(t.amount);if(isNaN(s)||s<=0){r.error("请输入有效金额");return}const d=t.tokenType==="HTP"?a==null?void 0:a.htp_balance:a==null?void 0:a.usdt_balance;if(!d||s>d){r.error("余额不足");return}if(t.tokenType==="HTP"&&!(a!=null&&a.wallet_activated)){r.error("请先激活钱包才能提取HTP代币");return}if(!t.paymentAddress){r.error("请输入验证转账钱包地址");return}F(!0);const re=await pe(s,t.tokenType,t.toAddress,t.paymentAddress);F(!1),re?(r.success("提币申请已提交，等待管理员审核"),x({amount:"",tokenType:"HTP",toAddress:"",paymentAddress:""}),await I()):r.error("提交失败，请稍后重试")};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold gradient-text",children:"钱包管理"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"管理您的钱包地址和提币操作"})]}),e.jsxs(f,{className:"glow-border",children:[e.jsxs(w,{children:[e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"w-6 h-6 text-primary"}),"钱包连接"]}),e.jsx(T,{children:"连接您的MetaMask钱包到BSC网络"})]}),e.jsx(C,{className:"space-y-4",children:h?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 rounded-lg bg-accent/30 border border-border",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"连接状态"}),e.jsxs(c,{variant:"secondary",className:"bg-green-500/10 text-green-500",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse mr-2"}),"已连接"]})]}),e.jsx("p",{className:"font-mono text-sm break-all",children:k})]}),e.jsx("div",{className:"p-4 rounded-lg bg-accent/30 border border-border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"网络"}),o?e.jsx(c,{variant:"secondary",className:"bg-green-500/10 text-green-500",children:"BSC网络"}):e.jsx(c,{variant:"secondary",className:"bg-red-500/10 text-red-500",children:"错误网络"})]})}),!o&&e.jsxs(p,{variant:"destructive",children:[e.jsx(A,{className:"h-4 w-4"}),e.jsx(g,{children:"请在MetaMask中切换到BSC（Binance Smart Chain）网络。"})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(p,{children:[e.jsx(A,{className:"h-4 w-4"}),e.jsx(g,{children:"请先安装MetaMask钱包扩展，然后点击下方按钮连接钱包。"})]}),e.jsxs(n,{onClick:Q,className:"w-full hover-glow",size:"lg",children:[e.jsx(G,{className:"w-5 h-5 mr-2"}),"连接MetaMask钱包"]})]})})]}),e.jsxs(f,{className:"glow-border",children:[e.jsxs(w,{children:[e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"w-6 h-6 text-primary"}),"绑定钱包地址 (可选)"]}),e.jsx(T,{children:"您可以绑定常用钱包地址，也可以在提币时手动输入"})]}),e.jsx(C,{className:"space-y-4",children:a!=null&&a.wallet_address?e.jsxs("div",{className:"space-y-4",children:[e.jsx(p,{children:e.jsxs(g,{children:[e.jsx("strong",{children:"已绑定地址："}),e.jsx("p",{className:"font-mono text-sm mt-2 break-all",children:a.wallet_address})]})}),e.jsxs(n,{variant:"outline",onClick:$,disabled:!h||!o||v,className:"w-full",children:[v&&e.jsx(j,{className:"mr-2 h-4 w-4 animate-spin"}),"更新绑定地址"]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"当前未绑定钱包地址。您可以选择绑定当前连接的钱包，方便后续操作。"}),e.jsxs(n,{onClick:$,disabled:!h||!o||v,className:"w-full hover-glow",size:"lg",children:[v&&e.jsx(j,{className:"mr-2 h-4 w-4 animate-spin"}),h?o?"绑定当前钱包地址":"请切换到BSC网络":"请先连接钱包"]})]})})]}),e.jsxs(f,{className:"glow-border-strong",children:[e.jsxs(w,{children:[e.jsxs(b,{className:"flex items-center gap-2",children:[e.jsx(ke,{className:"w-6 h-6 text-primary"}),"提币申请"]}),e.jsx(T,{children:"申请将代币转出到您的钱包地址"})]}),e.jsx(C,{children:e.jsxs(ce,{children:[e.jsx(ie,{asChild:!0,children:e.jsx(n,{className:"w-full hover-glow",size:"lg",children:"申请提币"})}),e.jsxs(de,{children:[e.jsxs(oe,{children:[e.jsx(xe,{children:"提币申请"}),e.jsx(me,{children:a!=null&&a.wallet_activated?"填写提币信息，提交后需要管理员审核":"您的钱包尚未激活，需要先激活才能提取HTP代币"})]}),a!=null&&a.wallet_activated?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"代币类型"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(n,{variant:t.tokenType==="HTP"?"default":"outline",onClick:()=>x({...t,tokenType:"HTP"}),className:"flex-1",children:["HTP (余额: ",((E=a==null?void 0:a.htp_balance)==null?void 0:E.toFixed(2))||"0.00",")"]}),e.jsxs(n,{variant:t.tokenType==="USDT"?"default":"outline",onClick:()=>x({...t,tokenType:"USDT"}),className:"flex-1",children:["USDT (余额: ",((O=a==null?void 0:a.usdt_balance)==null?void 0:O.toFixed(2))||"0.00",")"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"amount",children:"提币数量"}),e.jsx(u,{id:"amount",type:"number",placeholder:"请输入提币数量",value:t.amount,onChange:s=>x({...t,amount:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"toAddress",children:"接收地址"}),e.jsx(u,{id:"toAddress",type:"text",placeholder:"请输入接收地址",value:t.toAddress,onChange:s=>x({...t,toAddress:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"paymentAddress",children:"验证转账钱包地址"}),e.jsx(u,{id:"paymentAddress",type:"text",placeholder:"请输入您的付款钱包地址",value:t.paymentAddress,onChange:s=>x({...t,paymentAddress:s.target.value})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"提示：请填写用于验证身份的转账钱包地址，管理员审核通过后方可提币"})]}),e.jsxs(n,{onClick:te,disabled:W,className:"w-full hover-glow",children:[W&&e.jsx(j,{className:"mr-2 h-4 w-4 animate-spin"}),"提交申请"]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs(p,{variant:"destructive",children:[e.jsx(A,{className:"h-4 w-4"}),e.jsxs(g,{children:[e.jsx("strong",{children:"钱包待激活"}),e.jsxs("p",{className:"mt-2",children:["您的钱包地址尚未激活。需要向开发者转入 ",e.jsxs("strong",{children:[i," USDT"]})," 来激活钱包，激活后即可提取HTP代币。"]})]})]}),e.jsxs("div",{className:"space-y-3 p-4 rounded-lg bg-accent/30 border border-border",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:"激活费用"}),e.jsxs(c,{variant:"secondary",className:"bg-primary/10 text-primary",children:[i," USDT"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{className:"text-sm font-medium",children:"开发者USDT地址（BSC网络）"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(u,{value:U,readOnly:!0,className:"font-mono text-xs"}),e.jsx(n,{onClick:se,variant:"outline",size:"icon",children:q?e.jsx(we,{className:"h-4 w-4 text-green-500"}):e.jsx(ve,{className:"h-4 w-4"})})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["请使用您绑定的钱包地址向上述地址转账 ",i," USDT（BSC网络）"]})]})]}),e.jsx(p,{children:e.jsxs(g,{children:[e.jsx("strong",{children:"激活步骤："}),e.jsxs("ol",{className:"mt-2 space-y-1 text-sm list-decimal list-inside",children:[e.jsx("li",{children:"复制上方的开发者USDT地址"}),e.jsxs("li",{children:["使用您绑定的钱包向该地址转账 ",i," USDT（BSC网络）"]}),e.jsx("li",{children:"转账完成后，在下方输入实际支付金额"}),e.jsx("li",{children:'点击"确认激活"按钮'}),e.jsx("li",{children:"等待管理员确认后，钱包即可激活"}),e.jsx("li",{children:"支付的激活费用30 USDT去掉手续费后，可以返还HTP和USDT代币到您当前支付的地址。每一次交易都要扣除手续费，此手续费由币安链（BSC）收取"})]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"activationAmount",children:"实际支付金额（USDT）"}),e.jsx(u,{id:"activationAmount",type:"number",placeholder:`请输入支付的USDT金额（至少 ${i}）`,value:S,onChange:s=>z(s.target.value)})]}),e.jsxs(n,{onClick:ae,disabled:L||!S,className:"w-full hover-glow",size:"lg",children:[L&&e.jsx(j,{className:"mr-2 h-4 w-4 animate-spin"}),"确认激活钱包"]})]})]})]})})]}),e.jsxs(f,{children:[e.jsxs(w,{children:[e.jsx(b,{children:"提币记录"}),e.jsx(T,{children:"查看您的提币申请历史"})]}),e.jsx(C,{children:X?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(j,{className:"w-8 h-8 animate-spin text-primary"})}):B.length===0?e.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"暂无提币记录"}):e.jsx("div",{className:"rounded-md border",children:e.jsxs(ge,{children:[e.jsx(Ne,{children:e.jsxs(K,{children:[e.jsx(N,{children:"申请时间"}),e.jsx(N,{children:"代币"}),e.jsx(N,{className:"text-right",children:"数量"}),e.jsx(N,{children:"接收地址"}),e.jsx(N,{className:"text-right",children:"状态"})]})}),e.jsx(ye,{children:B.map(s=>e.jsxs(K,{children:[e.jsx(y,{className:"text-sm",children:new Date(s.created_at).toLocaleString("zh-CN")}),e.jsx(y,{children:e.jsx(c,{variant:"outline",children:s.token_type})}),e.jsx(y,{className:"text-right font-bold",children:s.amount.toFixed(2)}),e.jsxs(y,{className:"font-mono text-xs",children:[s.to_address.slice(0,10),"...",s.to_address.slice(-8)]}),e.jsxs(y,{className:"text-right",children:[s.status==="pending"&&e.jsx(c,{variant:"secondary",className:"bg-yellow-500/10 text-yellow-500",children:"审核中"}),s.status==="approved"&&e.jsx(c,{variant:"secondary",className:"bg-green-500/10 text-green-500",children:"已通过"}),s.status==="rejected"&&e.jsx(c,{variant:"secondary",className:"bg-red-500/10 text-red-500",children:"已拒绝"})]})]},s.id))})]})})})]})]})}export{Ue as default};
